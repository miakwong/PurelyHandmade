<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Purely Homemade - Products</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Poppins:wght@300;400;500;600&display=swap"
    rel="stylesheet">

  <!-- Core libraries first - Load in proper order -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Configuration and core services - load in proper order -->
  <script src="/~xzy2020c/PurelyHandmade/src/client/js/config.js"></script>
  <script src="/~xzy2020c/PurelyHandmade/src/client/js/data-service.js"></script>

  <!-- Custom CSS -->
  <script>
    // 确保CONFIG已加载
    if (typeof CONFIG !== 'undefined') {
      document.write(`
        <link rel="stylesheet" href="${CONFIG.getCssPath('product-list.css')}">
        <link rel="stylesheet" href="${CONFIG.getCssPath('navbar.css')}">
        <link rel="stylesheet" href="${CONFIG.getCssPath('global.css')}">
        <link rel="stylesheet" href="${CONFIG.getCssPath('toast.css')}">
      `);
    } else {
      console.error('CONFIG not loaded, unable to load CSS files');
      // 使用直接路径作为备选
      document.write(`
        <link rel="stylesheet" href="/~xzy2020c/PurelyHandmade/src/client/css/product-list.css">
        <link rel="stylesheet" href="/~xzy2020c/PurelyHandmade/src/client/css/navbar.css">
        <link rel="stylesheet" href="/~xzy2020c/PurelyHandmade/src/client/css/global.css">
        <link rel="stylesheet" href="/~xzy2020c/PurelyHandmade/src/client/css/toast.css">
      `);
    }
  </script>

  <!-- Make sure Bootstrap Icons are loaded -->
  <style>
    @import url("https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css");
  </style>
</head>

<body>

  <!-- Navbar Placeholder -->
  <div id="navbar-placeholder"></div>

  <!-- 主内容区 -->
  <main>
    <!-- breadcrumb -->
    <div class="container-custom">
      <nav aria-label="breadcrumb" class="modern-breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="CONFIG.ge">Home</a></li>
          <li class="breadcrumb-item active" id="breadcrumb-category">All Products</li>
        </ol>
      </nav>
    </div>

    <!-- 产品列表主体 -->
    <div class="container-custom">
      <h1 class="page-title" id="product-list-title">All Products</h1>

      <!-- 移动端筛选器切换按钮 - 仅在小屏幕显示 -->
      <button class="btn w-100 d-lg-none mb-3" id="product-filters-mobile-toggle"
        style="background-color: var(--accent-color); color: white;">
        <i class="bi bi-funnel-fill me-2"></i> Show Filters
      </button>

      <div class="row">
        <!-- 左侧筛选栏 -->
        <div class="col-lg-3">
          <div class="filter-sidebar filter-sidebar-mobile-collapse d-lg-block">
            <h4>Refine Selection</h4>

            <!-- 分类筛选 -->
            <div class="filter-group">
              <div class="filter-group-title">
                <span>Categories</span>
                <i class="bi bi-chevron-up"></i>
              </div>
              <div class="filter-group-content show" id="category-filters">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="all" id="category-all" checked>
                  <label class="form-check-label" for="category-all">
                    All Categories
                  </label>
                </div>
                <!-- 分类选项将在这里动态生成 -->
              </div>
            </div>

            <!-- 价格筛选 -->
            <div class="filter-group">
              <div class="filter-group-title">
                <span>Price Range</span>
                <i class="bi bi-chevron-down"></i>
              </div>
              <div class="filter-group-content" id="price-filter">
                <div class="price-range-inputs">
                  <div class="input-group input-group-sm">
                    <span class="input-group-text">$</span>
                    <input type="number" class="form-control" id="price-min" min="0" placeholder="Min">
                  </div>
                  <span>-</span>
                  <div class="input-group input-group-sm">
                    <span class="input-group-text">$</span>
                    <input type="number" class="form-control" id="price-max" min="0" placeholder="Max">
                  </div>
                </div>
                <button class="btn btn-sm w-100" id="apply-price-filter"
                  style="background-color: var(--accent-color); color: white;">Apply</button>
              </div>
            </div>

            <!-- 评分筛选 -->
            <div class="filter-group">
              <div class="filter-group-title">
                <span>Rating</span>
                <i class="bi bi-chevron-down"></i>
              </div>
              <div class="filter-group-content">
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="rating-filter" id="rating-all" value="0" checked>
                  <label class="form-check-label" for="rating-all">
                    All Ratings
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="rating-filter" id="rating-4plus" value="4">
                  <label class="form-check-label" for="rating-4plus">
                    4+ <i class="bi bi-star-fill text-warning"></i> & up
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="rating-filter" id="rating-3plus" value="3">
                  <label class="form-check-label" for="rating-3plus">
                    3+ <i class="bi bi-star-fill text-warning"></i> & up
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="rating-filter" id="rating-2plus" value="2">
                  <label class="form-check-label" for="rating-2plus">
                    2+ <i class="bi bi-star-fill text-warning"></i> & up
                  </label>
                </div>
              </div>
            </div>

            <!-- 特惠筛选 -->
            <div class="filter-group">
              <div class="filter-group-title">
                <span>Deals</span>
                <i class="bi bi-chevron-down"></i>
              </div>
              <div class="filter-group-content">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="filter-sale">
                  <label class="form-check-label" for="filter-sale">
                    On Sale
                  </label>
                </div>
              </div>
            </div>

            <!-- 重置筛选按钮 -->
            <button class="btn w-100 mt-3" id="reset-filters"
              style="background-color: var(--primary-color); color: var(--text-color);">
              <i class="bi bi-arrow-counterclockwise me-2"></i> Reset Filters
            </button>
          </div>
        </div>

        <!-- 右侧产品列表 -->
        <div class="col-lg-9">
          <!-- 产品工具栏 -->
          <div class="product-toolbar">
            <div id="product-count">Showing 0 products</div>
            <div class="d-flex align-items-center flex-wrap">
              <label for="sort-select" class="me-3 mb-2 mb-sm-0">Sort By:</label>
              <select class="sort-select me-3 me-sm-4 mb-2 mb-sm-0" id="sort-select">
                <option value="featured">Featured</option>
                <option value="price-low">Price: Low to High</option>
                <option value="price-high">Price: High to Low</option>
                <option value="rating">Highest Rated</option>
                <option value="newest">Newest</option>
              </select>

              <label for="products-per-page" class="me-2 mb-2 mb-sm-0">Show:</label>
              <select class="products-per-page-select" id="products-per-page">
                <option value="8">8</option>
                <option value="12" selected>12</option>
                <option value="24">24</option>
              </select>
            </div>
          </div>

          <!-- 产品网格 -->
          <div class="row product-grid" id="products-container">
            <!-- 产品将在这里动态加载 -->
          </div>

          <!-- 分页控件 -->
          <nav aria-label="Products pagination">
            <ul class="pagination modern-pagination justify-content-center" id="pagination">
              <!-- 分页将在这里动态生成 -->
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </main>

  <!-- 现代Toast通知容器 -->
  <div class="modern-toast-container" id="toast-container"></div>

  <!-- Footer Placeholder -->
  <div id="footer-placeholder"></div>

  <!-- 其他脚本加载 - 按正确顺序加载 -->
  <script src="/~xzy2020c/PurelyHandmade/src/client/js/api-data-loader.js"></script>
  <script src="/~xzy2020c/PurelyHandmade/src/client/js/navbar-handler.js"></script>
  <script src="/~xzy2020c/PurelyHandmade/src/client/js/product-list.js"></script>
  
  <!-- 添加移动端筛选器显示隐藏功能 -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const filterToggleBtn = document.getElementById('product-filters-mobile-toggle');
      const filterSidebar = document.querySelector('.filter-sidebar');
      
      if (filterToggleBtn && filterSidebar) {
        filterToggleBtn.addEventListener('click', function() {
          filterSidebar.classList.toggle('show');
          
          if (filterSidebar.classList.contains('show')) {
            filterToggleBtn.innerHTML = '<i class="bi bi-funnel-fill me-2"></i> Hide Filters';
          } else {
            filterToggleBtn.innerHTML = '<i class="bi bi-funnel-fill me-2"></i> Show Filters';
          }
        });
      }
    });
  </script>

</body>

</html>