<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Profile</title>
  <link rel="stylesheet" href="../../assets/css/profile.css">
  <link rel="stylesheet" href="../../assets/css/navbar.css">  
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>
<body>

  <div id="navbar-placeholder"></div>
  <div class="container">
    
    <!-- Sidebar with Profile Photo and Basic Information -->
    <aside class="sidebar">
      <div class="profile-photo">
        <img src="../../assets/img/profile.png" alt="Profile Photo" id="profile-img">
      </div>
      <input type="file" id="profile-photo-upload" accept="image/png, image/jpeg" onchange="updateProfilePhoto(event)" style="display: none;">
      <button onclick="document.getElementById('profile-photo-upload').click()">Change Profile Photo</button>
      
      <h2 id="user-name">User Name</h2>
      <p class="job-title">User Email: <span id="user-email">user@example.com</span></p>
      
      <p class="quote">Welcome to your profile!</p>
    </aside>

    <!-- Main Content Area -->
    <main class="content">
      <!-- Personal Information Section -->
      <section class="card personal-info">
        <h3>Personal Information</h3>
        <form id="profile-form">
          <label for="username">Name:</label>
          <input type="text" id="username" required>
  
          <label for="email">Email:</label>
          <input type="email" id="email" required>
  
          <p id="error-message" style="color: red;"></p>
          <button type="submit">Save Changes</button>
        </form>
      </section>
    </main>
  </div>

  <!-- navbar.html -->
  <script>
      document.addEventListener("DOMContentLoaded", function () {
        fetch("../../assets/layout/navbar.html") 
              .then(response => response.text())
              .then(data => {
                  document.getElementById("navbar-placeholder").innerHTML = data;
              });
      });

      $(document).ready(() => {
          $("#profile-form").submit(function (event) {
              event.preventDefault(); 
              let name = $("#username").val().trim();
              let email = $("#email").val().trim();
              let file = $("#profile-photo-upload")[0].files[0];
              let errorMessage = "";
    
              if (name === "") {
                  errorMessage = "❌ Name cannot be empty!";
              } else if (!email.includes("@") || !email.includes(".")) {
                  errorMessage = "❌ Invalid email format!";
              } else if (file && !(file.type === "image/jpeg" || file.type === "image/png")) {
                  errorMessage = "❌ Profile picture must be a JPG or PNG file!";
              }
    
              if (errorMessage) {
                  $("#error-message").text(errorMessage);
              } else {
                  $("#error-message").text("Profile updated successfully!").css("color", "green");
                  $("#user-name").text(name);
                  $("#user-email").text(email);
              }
          });
      });

      function updateProfilePhoto(event) {
          const file = event.target.files[0];
          if (file && (file.type === "image/jpeg" || file.type === "image/png")) {
              const reader = new FileReader();
              reader.onload = function (e) {
                  document.getElementById("profile-img").src = e.target.result;
              };
              reader.readAsDataURL(file);
          } else {
              alert("Please upload a valid JPG or PNG image.");
          }
      }
  </script>

</body>
</html>
