<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>localStorage Diagnostic Tool</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    pre {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 5px;
      max-height: 300px;
      overflow: auto;
    }
    .result-box {
      margin-top: 20px;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div class="container my-5">
    <h1>localStorage Diagnostic Tool</h1>
    <p>Use this tool to check your localStorage status and resolve product display issues</p>

    <div class="card mb-4">
      <div class="card-header">
        <h4>Check Admin Status</h4>
      </div>
      <div class="card-body">
        <p>Current admin status: <span id="admin-status" class="badge bg-secondary">Checking...</span></p>
        <button id="set-admin-true" class="btn btn-success">Set as Admin</button>
        <button id="set-admin-false" class="btn btn-secondary">Remove Admin</button>
      </div>
    </div>

    <div class="card mb-4">
      <div class="card-header">
        <h4>Check Product Data</h4>
      </div>
      <div class="card-body">
        <p>Product count: <span id="product-count" class="badge bg-secondary">Checking...</span></p>
        <div class="result-box">
          <h5>Product data:</h5>
          <pre id="products-data">Checking...</pre>
        </div>
        <button id="init-test-products" class="btn btn-primary">Initialize Test Products</button>
        <button id="clear-products" class="btn btn-danger">Clear Product Data</button>
      </div>
    </div>

    <div class="card mb-4">
      <div class="card-header">
        <h4>Check Designer Data</h4>
      </div>
      <div class="card-body">
        <p>Designer count: <span id="designer-count" class="badge bg-secondary">Checking...</span></p>
        <div class="result-box">
          <h5>Designer data:</h5>
          <pre id="designers-data">Checking...</pre>
        </div>
        <button id="init-test-designers" class="btn btn-primary">Initialize Test Designers</button>
      </div>
    </div>

    <div class="card mb-4">
      <div class="card-header">
        <h4>Check Category Data</h4>
      </div>
      <div class="card-body">
        <p>Category count: <span id="category-count" class="badge bg-secondary">Checking...</span></p>
        <div class="result-box">
          <h5>Category data:</h5>
          <pre id="categories-data">Checking...</pre>
        </div>
        <button id="init-test-categories" class="btn btn-primary">Initialize Test Categories</button>
      </div>
    </div>

    <div class="alert alert-info">
      <h4>Instructions:</h4>
      <ol>
        <li>Click the "Set as Admin" button to ensure you have admin privileges</li>
        <li>Check if product data exists; if not, click "Initialize Test Products"</li>
        <li>Ensure category data exists; if not, click "Initialize Test Categories"</li>
        <li>When finished, return to <a href="src/views/auth/profile.html" class="alert-link">User Profile Page</a> and refresh</li>
      </ol>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Check admin status
      checkAdminStatus();
      
      // Check product data
      checkProductsData();
      
      // Check designer data
      checkDesignersData();
      
      // Check category data
      checkCategoriesData();
      
      // Set up event listeners
      setupEventListeners();
    });

    // Check admin status
    function checkAdminStatus() {
      const isAdmin = localStorage.getItem('isAdmin') === 'true';
      const statusEl = document.getElementById('admin-status');
      
      statusEl.textContent = isAdmin ? 'Enabled' : 'Disabled';
      statusEl.className = `badge ${isAdmin ? 'bg-success' : 'bg-danger'}`;
    }

    // Check product data
    function checkProductsData() {
      const products = JSON.parse(localStorage.getItem('products') || '[]');
      const countEl = document.getElementById('product-count');
      const dataEl = document.getElementById('products-data');
      
      countEl.textContent = products.length;
      countEl.className = `badge ${products.length > 0 ? 'bg-success' : 'bg-danger'}`;
      
      dataEl.textContent = products.length > 0 
        ? JSON.stringify(products, null, 2).substring(0, 1000) + (JSON.stringify(products, null, 2).length > 1000 ? '...' : '')
        : 'No product data';
    }

    // Check designer data
    function checkDesignersData() {
      const designers = JSON.parse(localStorage.getItem('designers') || '[]');
      const countEl = document.getElementById('designer-count');
      const dataEl = document.getElementById('designers-data');
      
      countEl.textContent = designers.length;
      countEl.className = `badge ${designers.length > 0 ? 'bg-success' : 'bg-danger'}`;
      
      dataEl.textContent = designers.length > 0 
        ? JSON.stringify(designers, null, 2)
        : 'No designer data';
    }

    // Check category data
    function checkCategoriesData() {
      const categories = JSON.parse(localStorage.getItem('categories') || '[]');
      const countEl = document.getElementById('category-count');
      const dataEl = document.getElementById('categories-data');
      
      countEl.textContent = categories.length;
      countEl.className = `badge ${categories.length > 0 ? 'bg-success' : 'bg-danger'}`;
      
      dataEl.textContent = categories.length > 0 
        ? JSON.stringify(categories, null, 2)
        : 'No category data';
    }

    // Set up event listeners
    function setupEventListeners() {
      // Admin status buttons
      document.getElementById('set-admin-true').addEventListener('click', function() {
        localStorage.setItem('isAdmin', 'true');
        checkAdminStatus();
      });
      
      document.getElementById('set-admin-false').addEventListener('click', function() {
        localStorage.setItem('isAdmin', 'false');
        checkAdminStatus();
      });
      
      // Product data buttons
      document.getElementById('init-test-products').addEventListener('click', function() {
        initTestProducts();
        checkProductsData();
      });
      
      document.getElementById('clear-products').addEventListener('click', function() {
        if (confirm('Are you sure you want to clear all product data?')) {
          localStorage.setItem('products', '[]');
          checkProductsData();
        }
      });
      
      // Designer data buttons
      document.getElementById('init-test-designers').addEventListener('click', function() {
        initTestDesigners();
        checkDesignersData();
      });
      
      // Category data buttons
      document.getElementById('init-test-categories').addEventListener('click', function() {
        initTestCategories();
        checkCategoriesData();
      });
    }

    // Initialize test products
    function initTestProducts() {
      const testProducts = [
        {
          id: 1,
          name: "Handmade Ceramic Vase",
          categoryId: 1,
          price: 49.99,
          stock: 15,
          description: "Handcrafted ceramic vase with minimalist design, perfect for any occasion.",
          details: "Size: 20cm height, 10cm diameter<br>Material: High-quality ceramic<br>Style: Modern minimalist<br>Suitable for: Living room, dining room, study",
          onSale: false,
          salePrice: null,
          images: ["../../assets/img/product1.jpg", "../../assets/img/product1-2.jpg"],
          listingDate: new Date().toISOString(),
          reviews: []
        },
        {
          id: 2,
          name: "Handwoven Basket",
          categoryId: 2,
          price: 35.99,
          stock: 8,
          description: "Handwoven practical basket made from natural materials, eco-friendly and durable.",
          details: "Size: 30cm diameter, 15cm height<br>Material: Natural rattan<br>Uses: Storage, decoration, picnic<br>Features: Eco-friendly, durable, natural",
          onSale: true,
          salePrice: 29.99,
          images: ["../../assets/img/product2.jpg"],
          listingDate: new Date().toISOString(),
          reviews: [
            {
              userName: "John Smith",
              rating: 5,
              title: "Excellent quality",
              content: "The quality is excellent, very satisfied!",
              date: new Date().toISOString()
            }
          ]
        },
        {
          id: 3,
          name: "Handmade Wool Blanket",
          categoryId: 3,
          price: 89.99,
          stock: 5,
          description: "Hand-knitted wool blanket, warm and comfortable with a soft touch.",
          details: "Size: 150cm x 200cm<br>Material: Premium wool<br>Features: Soft, warm, breathable<br>Suitable for: Sofa, bed, camping",
          onSale: false,
          salePrice: null,
          images: ["../../assets/img/product3.jpg"],
          listingDate: new Date().toISOString(),
          reviews: []
        }
      ];
      
      localStorage.setItem('products', JSON.stringify(testProducts));
      alert('Successfully initialized 3 test products!');
    }

    // Initialize test designers
    function initTestDesigners() {
      const testDesigners = [
        {
          id: "d1",
          name: "Michael Lee",
          specialty: "Ceramic Art",
          bio: "Senior ceramic artist with 15 years of experience in ceramic creation. Works have been exhibited in multiple international exhibitions.",
          image: "../../assets/img/designer1.jpg",
          images: ["../../assets/img/designer1.jpg"],
          social: {
            instagram: "https://instagram.com/michaelleeart",
            pinterest: "https://pinterest.com/michaelleeart",
            etsy: "https://etsy.com/shop/michaelleeart"
          }
        },
        {
          id: "d2",
          name: "Emma Wong",
          specialty: "Handweaving",
          bio: "Focused on natural material weaving, pursuing the combination of traditional craftsmanship and modern design.",
          image: "../../assets/img/designer2.jpg",
          images: ["../../assets/img/designer2.jpg"],
          social: {
            instagram: "https://instagram.com/emmawong",
            pinterest: "",
            etsy: "https://etsy.com/shop/emmawong"
          }
        }
      ];
      
      localStorage.setItem('designers', JSON.stringify(testDesigners));
      alert('Successfully initialized 2 test designers!');
    }

    // Initialize test categories
    function initTestCategories() {
      const testCategories = [
        {
          id: 1,
          name: "Ceramics",
          description: "Handmade ceramic products including vases, tableware, decorative items, and more.",
          image: "../../assets/img/category1.jpg"
        },
        {
          id: 2,
          name: "Wooden Crafts",
          description: "Meticulously crafted wooden artifacts including furniture, decorative items, and practical tools.",
          image: "../../assets/img/category2.jpg"
        },
        {
          id: 3,
          name: "Textiles",
          description: "Hand-woven textile products including blankets, cushions, curtains, and more.",
          image: "../../assets/img/category3.jpg"
        }
      ];
      
      localStorage.setItem('categories', JSON.stringify(testCategories));
      alert('Successfully initialized 3 test categories!');
    }
  </script>
</body>
</html> 